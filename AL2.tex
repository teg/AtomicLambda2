

\documentclass{amsart}

\usepackage{AL2macros}

\setTheoremStyles

\pagestyle{empty}
\thispagestyle{empty}


\begin{document}

\section*{Terms}

\begin{definition}
\label{def:basic calculus}
The \emph{basic calculus} $\Lambda_A^-$ is given by the grammar
%
\setMidspace{6pt}
%
\[
\begin{array}{@{}r@{}l@{~}l@{}}
        t,u,v \Coloneq &
x
\Mid		(t)u
\Mid            \lambda x.(t\share xx)
\Mid\\[5pt] &   \lambda y^{\tup x}.(t\cxt*{x_1}\ldots\cxt*{x_n})
\Mid\\[5pt] &   u\share xt
\Mid            u\share x{\tup y}
\end{array}
\]
%
where
\begin{itemize}
	\item[(i)] each variable may occur at most once, 
	\item[(ii)] each variable may be bound at most once,
	\item[(iii)] in $u\share xt$ each $x_i$ must occur in $u$, and becomes
                bound,
        \item[(iv)] in $u\share x{\tup y}$ each path starting from an $x_i$,
                must end in a variable $z_j$ in the scope of an $\lambda
                y_i^{\tup z}$; and every $y_k$ must occur as a binder in $u$.
\end{itemize}
\end{definition}


A sequence of variables $\vv x$ will be abbreviated $\vv*x$, so that the sharing constructor above can be written $u\share*{\vv*x}t$.

Sharings will be abbreviated $\g$; a series of sharings will be denoted $\G$.
%
To identify subterms the special \emph{hole}-constructor $\cxt[\vv x]$ will be
used, which carries a sequence of free variables $\vv x$ so that sharings can be
applied to it, as for example in $\cxt[\vv x]\share xt$; where convenient, the
variables of a hole will be omitted.
%
A \emph{context} $t\cxt[\vv x]$ is a term containing a single hole; the term $t\cxt*u$ is obtained by replacing the hole in $t\cxt$ with the term $u$, but only if $\FV(u)=\{\vv x\}$

In the following we make crucial use of the fact that the hole construction is
not commutative. In particular $u\cxt*{v\cxt*t}$ may be written as $u\cxt*v\cxt*t$.

\[
	\rule{200pt}{.5pt}
\]

\section*{Rewriting}

\noindent
Permutations
\[
\displayrewrite
{ (u\g)t }
{ ((u)t)\g }
\]

\bigskip

\[
\displayrewrite
{ (u)t\g }
{ ((u)t)\g }
\]

\[
\displayrewrite
{ u\share x{t\g} }
{ u\share xt\g }
\]

\noindent
If $\{\vv x\}\cap\FV(\g)=\emptyset$:
\[
\displayrewrite
{ \lambda x.(t\g\share xx)}
{ (\lambda x. (t\share xx)) \g }\;.
\]

\noindent
If $\{\vv y\}\cap\FV(\g)=\emptyset$:
\[
\displayrewrite
{ \lambda x^{\tup y}.(t\g) }
{ (\lambda x^{\tup y}.t)\g }\;.
\]

\noindent
If $\FV(\share zv)\subset\{\vv y\}$:
\[
\displayrewrite
{ \lambda x^{\tup y}.(t\share[m] zv) }
{ (\lambda x^{\tup*{y_1,\dots,y_n,z_1,\dots,z_m} \setminus \FV(v)}.t)\share zv }\;.
\]

\bigskip
\bigskip
\bigskip

\noindent
Compounding closures
\[
\displayrewrite
{ u\share x{y_i}\share[m] yt }
{ u\share* {y_1, \dotsc, y_{i-1}, \vv x, y_{i+1}, \dotsc, y_m}t }
\]

\bigskip
\bigskip
\bigskip

\noindent
Duplicate application and abstraction
\[
\displayrewrite
{ u\cxt*{x_1}\ldots\cxt*{x_n}\share x{(v)t} }
{ u'\cxt*{(y_1)z_1}\dots\cxt*{(y_n)z_n}\share yv\share zt }\;,
\]
where $u'$ is obtained from $u$ by replacing every $\lambda
q_j^{\tup*{x_i,\vv*w}}$ with $\lambda q_j^{\tup*{y_i,z_i,\vv*w}}$.

\bigskip

\[
\displayrewrite
{ u\cxt*{x_1}\ldots\cxt*{x_n}\share x{\lambda y.(t\share zy)} }
{ u\cxt*{\lambda y_1^{\tup*{x_1}}.x_1}\ldots\cxt*{\lambda
  y_n^{\tup*{x_n}}.x_n}\share xt\share z{\tup y} }
\]

\bigskip
\bigskip
\bigskip

\noindent
Distributor elimination
\[
\displayrewrite
{ u\cxt* {\lambda y_1^{\tup*{\vv*x_1,\vv*z_1}}.t_1}\ldots\cxt* {\lambda
y_n^{\tup*{\vv*x_n,\vv*z_n}}.t_n}\share* {\vv*x_1,\dots,\vv*x_n}{\tup y} }
{ u\cxt* {\lambda y_1.(t_1\share* {\vv*x_1}{y_1})}\ldots\cxt* {\lambda
y_n.(t_n\share* {\vv*x_n}{y_n})} }
\]

\end{document}
